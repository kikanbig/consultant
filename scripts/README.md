# Скрипты для обновления базы данных

## updateDivans.py

Скрипт для обновления базы данных диванов из Excel файла с автоматической генерацией алиасов.

### Использование

```bash
cd /Users/kikanbig/21vek/Алиса
python3 scripts/updateDivans.py
```

### Что делает скрипт

1. **Читает Excel файл** `Файл для диванов/Диваны, крессла, матрасы розница (1).xlsx`
2. **Парсит данные** из листа "Мягкая мебель":
   - Код товара (артикул)
   - Название
   - Описание (очищает от HTML)
   - Бренд и модель (автоматически извлекает из названия)

3. **Генерирует алиасы** для каждого товара:
   - **Алиасы брендов**: латиница + кириллица + варианты написания
   - **Алиасы моделей**: транслитерация + варианты написания

4. **Сохраняет в JSON** `src/data/divans.json`

### Примеры сгенерированных алиасов

#### Бренды:
- **VELUNA** → `veluna`, `велуна`, `велюна`, `илуна`, `iluna`, `вилуна`
- **ELVA** → `elva`, `элва`, `эльва`, `елва`, `ельва`
- **Mio Tesoro** → `mio tesoro`, `мио тесоро`, `мио тезоро`, `миа тесоро`, `mio`, `миа`

#### Модели:
- **Юкки** → `юкки`, `юки`, `yuki`, `yukki`
- **Гизела** → `гизела`, `гизелла`, `gizela`
- **Кьянти** → `кьянти`, `киянти`, `chianti`, `kyanti`
- **Майами** → `майами`, `маями`, `miami`

### Когда запускать

Запускайте скрипт **каждый раз**, когда обновляете Excel файл с диванами:

1. Обновите файл `Файл для диванов/Диваны, крессла, матрасы розница (1).xlsx`
2. Запустите скрипт: `python3 scripts/updateDivans.py`
3. Закоммитьте изменения: `git add . && git commit -m "Обновлена база диванов" && git push`

### Добавление новых алиасов

Если нужно добавить новые алиасы для брендов или моделей, отредактируйте файл `scripts/updateDivans.py`:

#### Для брендов:
```python
BRAND_ALIASES = {
    'НовыйБренд': ['newbrand', 'новыйбренд', 'новый бренд'],
    # ...
}
```

#### Для моделей:
```python
TRANSLIT_MAP = {
    'newmodel': ['новаямодель', 'новая модель'],
    # ...
}
```

### Структура JSON

```json
{
  "divans": [
    {
      "kod": "10091617",
      "name": "Диван ELVA Аспен (Diagonal 694, опора черная)",
      "brand": "ELVA",
      "model": "Аспен",
      "brandAliases": ["elva", "элва", "эльва", "елва", "ельва"],
      "modelAliases": ["аспен", "aspen"],
      "description": "ASPEN — это прямой диван..."
    }
  ]
}
```

### Статистика

После запуска скрипт выводит:
- Количество обработанных товаров
- Общее количество алиасов брендов и моделей
- Примеры первых 5 товаров с их алиасами

### Troubleshooting

**Проблема**: Скрипт не находит Excel файл
**Решение**: Убедитесь, что файл находится в `Файл для диванов/Диваны, крессла, матрасы розница (1).xlsx`

**Проблема**: Бренд или модель парсятся неправильно
**Решение**: Отредактируйте регулярные выражения в функции парсинга или добавьте специальный случай

**Проблема**: Алиасы не генерируются для конкретной модели
**Решение**: Добавьте модель в `TRANSLIT_MAP` с нужными вариантами

